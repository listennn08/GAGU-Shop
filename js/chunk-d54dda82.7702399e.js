(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d54dda82"],{"0703":function(t,e,n){"use strict";n.d(e,"g",(function(){return u})),n.d(e,"h",(function(){return l})),n.d(e,"c",(function(){return r})),n.d(e,"l",(function(){return d})),n.d(e,"d",(function(){return p})),n.d(e,"f",(function(){return g})),n.d(e,"b",(function(){return f})),n.d(e,"k",(function(){return b})),n.d(e,"i",(function(){return h})),n.d(e,"a",(function(){return v})),n.d(e,"j",(function(){return m})),n.d(e,"m",(function(){return C})),n.d(e,"e",(function(){return _}));n("99af");var o=n("bc3a"),a=n.n(o),c=n("2b1d"),s="dd62b88f-6f23-42a4-8551-b1cb4552bb3e",i=a.a.create({timeout:3e4,baseURL:"https://course-ec-api.hexschool.io/api/".concat(s,"/admin/")});i.interceptors.request.use((function(t){var e=t;return e.headers.Authorization="Bearer ".concat(c["a"].getItem("token")),e}));var u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return i.get("ec/products?page=".concat(t))},l=function(t){return i.get("ec/product/".concat(t))},r=function(t){return i.post("ec/product",t)},d=function(t,e){return i.patch("ec/product/".concat(t),e)},p=function(t){return i.delete("ec/product/".concat(t))},g=function(){return i.get("ec/coupons")},f=function(t){return i.post("ec/coupon",t)},b=function(t,e){return i.patch("ec/coupon/".concat(t),e)},h=function(){return i.get("ec/orders")},v=function(t,e){return i.patch("ec/orders/".concat(t,"/").concat(e?"paid":"unpaid"))},m=function(){return i.get("storage")},C=function(t){return i.post("storage",t)},_=function(t){return i.delete("storage/".concat(t))}},"09a2":function(t,e,n){"use strict";var o=n("55ee"),a=n.n(o);a.a},"0e4b":function(t,e,n){"use strict";var o=n("afb4"),a=n.n(o);a.a},"55ee":function(t,e,n){},"8c58":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container is-fluid"},[n("button",{staticClass:"button is-cus-primary is-pulled-right",attrs:{"data-action":"add"},on:{click:function(e){return t.openPage()}}},[n("span",{staticClass:"icon is-small"},[n("font-awesome-icon",{attrs:{icon:["fas","plus"]}})],1),n("span",[t._v("新增")])]),n("table",{staticClass:"table is-fullwidth"},[t._m(0),t._l(t.coupons,(function(e,o){return n("tr",{key:e.id,staticClass:"item-list",attrs:{"data-id":e.id,"data-index":o}},[n("td",{staticClass:"col"},[n("div",{staticClass:"text"},[t._v(t._s(e.title))])]),n("td",{staticClass:"col"},[n("div",{staticClass:"text"},[t._v(t._s(e.code))])]),n("td",{staticClass:"col"},[n("div",{staticClass:"text"},[t._v(t._s(e.percent)+"%")])]),n("td",{staticClass:"col"},[n("div",{staticClass:"control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.enabled,expression:"item.enabled"}],staticClass:"switch",class:{"is-success":e.enabled},attrs:{id:e.id,type:"checkbox"},domProps:{checked:Array.isArray(e.enabled)?t._i(e.enabled,null)>-1:e.enabled},on:{change:[function(n){var o=e.enabled,a=n.target,c=!!a.checked;if(Array.isArray(o)){var s=null,i=t._i(o,s);a.checked?i<0&&t.$set(e,"enabled",o.concat([s])):i>-1&&t.$set(e,"enabled",o.slice(0,i).concat(o.slice(i+1)))}else t.$set(e,"enabled",c)},function(e){return t.changeAttr(o)}]}}),n("label",{attrs:{for:e.id}},[t._v(t._s(t.checkEnabled(e.enabled)))])])]),n("td",{staticClass:"col"},[n("div",{staticClass:"text"},[t._v(t._s(e.deadline.datetime))])]),n("td",{staticClass:"col"},[n("div",{staticClass:"buttons is-centered"},[n("button",{staticClass:"button",attrs:{"data-action":"update"},on:{click:function(e){return t.openPage(o)}}},[n("span",{staticClass:"icon is-small"},[n("font-awesome-icon",{attrs:{icon:["fas","edit"]}})],1),n("span",[t._v("修改")])]),n("button",{staticClass:"button",class:{"is-loading":t.loading},on:{click:function(e){return t.deleteProduct(o)}}},[n("span",{staticClass:"icon is-small"},[n("font-awesome-icon",{attrs:{icon:["fas","trash-alt"]}})],1),n("span",[t._v("刪除")])])])])])}))],2),n("Coupon",{class:{"is-active":t.page.open}})],1)},a=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("tr",{staticClass:"has-cus-background-dark"},[n("th",{staticClass:"has-text-light"},[t._v("折扣名稱")]),n("th",{staticClass:"has-text-light"},[t._v("折扣碼")]),n("th",{staticClass:"has-text-light"},[t._v("折扣")]),n("th",{staticClass:"has-text-light"},[t._v("啟用狀態")]),n("th",{staticClass:"has-text-light"},[t._v("到期日")]),n("th",{staticClass:"has-text-light"},[t._v("編輯")])])}],c=n("5530"),s=n("2f62"),i=n("0703"),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal"},[n("div",{staticClass:"modal-background",on:{click:function(e){return t.cancel()}}}),n("div",{staticClass:"modal-card"},[n("header",{staticClass:"modal-card-head"},[n("h4",{staticClass:"is-size-4"},[t._v(t._s(t.title)+"優惠")])]),n("section",{staticClass:"modal-card-body"},[n("div",{staticClass:"modal-conetnt"},[n("div",{staticClass:"field has-text-left"},[n("label",[t._v("名稱")]),n("div",{staticClass:"control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.coupon.title,expression:"coupon.title"}],staticClass:"input",attrs:{type:"text"},domProps:{value:t.coupon.title},on:{input:function(e){e.target.composing||t.$set(t.coupon,"title",e.target.value)}}})]),n("label",[t._v("折扣碼")]),n("div",{staticClass:"control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.coupon.code,expression:"coupon.code"}],staticClass:"input",attrs:{type:"text"},domProps:{value:t.coupon.code},on:{input:function(e){e.target.composing||t.$set(t.coupon,"code",e.target.value)}}})]),n("label",[t._v("折扣")]),n("div",{staticClass:"control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.coupon.percent,expression:"coupon.percent"}],staticClass:"input",attrs:{type:"number"},domProps:{value:t.coupon.percent},on:{input:function(e){e.target.composing||t.$set(t.coupon,"percent",e.target.value)}}})]),n("label",[t._v("到期日")]),n("div",{staticClass:"control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.coupon.deadline_at,expression:"coupon.deadline_at"}],staticClass:"input",attrs:{type:"datetime-local"},domProps:{value:t.coupon.deadline_at},on:{input:function(e){e.target.composing||t.$set(t.coupon,"deadline_at",e.target.value)}}})]),n("label",[t._v("啟用狀態")]),n("div",{staticClass:"control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.coupon.enabled,expression:"coupon.enabled"}],staticClass:"switch",class:{"is-success":t.coupon.enabled},attrs:{id:t.coupon.id,type:"checkbox"},domProps:{checked:Array.isArray(t.coupon.enabled)?t._i(t.coupon.enabled,null)>-1:t.coupon.enabled},on:{change:function(e){var n=t.coupon.enabled,o=e.target,a=!!o.checked;if(Array.isArray(n)){var c=null,s=t._i(n,c);o.checked?s<0&&t.$set(t.coupon,"enabled",n.concat([c])):s>-1&&t.$set(t.coupon,"enabled",n.slice(0,s).concat(n.slice(s+1)))}else t.$set(t.coupon,"enabled",a)}}}),n("label",{attrs:{for:t.coupon.id}},[t._v(t._s(t.checkEnabled(t.coupon.enabled)))])])])])]),n("footer",{staticClass:"modal-card-foot"},[t.coupon.id?n("button",{staticClass:"button is-cus-primary",class:{"is-loading":t.loading},attrs:{"data-action":"update",type:"button"},on:{click:function(e){return e.preventDefault(),t.edit(e)}}},[t._v("更新")]):n("button",{staticClass:"button is-cus-primary",class:{"is-loading":t.loading},attrs:{"data-action":"create",type:"button"},on:{click:function(e){return e.preventDefault(),t.edit(e)}}},[t._v("新增")]),n("button",{staticClass:"button",attrs:{type:"button"},on:{click:t.cancel}},[t._v("取消")])])])])},l=[],r=n("c1df"),d=n.n(r),p={name:"Coupon",computed:Object(c["a"])(Object(c["a"])({},Object(s["c"])({coupon:"coupon/coupon",loading:"loading"})),{},{title:function(){return this.coupon.id?"更新":"新增"},checkEnabled:function(){return function(t){return t?"啟用":"未啟用"}},check:{get:function(){return this.coupon.enabled},set:function(){this.setEnabled()}}}),methods:Object(c["a"])(Object(c["a"])({},Object(s["b"])({setMsg:"setMsg",addCoupon:"coupon/addCoupon",updateCoupon:"coupon/updateCoupon",deleteCoupon:"coupon/deleteCoupon",clearTempCoupon:"coupon/clearTempCoupon",setEnabled:"coupon/setEnabled",toggleLoading:"toggleLoading",togglePage:"togglePage"})),{},{edit:function(t){var e=this;this.toggleLoading();var n=t.target.dataset.action;this.coupon.deadline_at=d()(this.coupon.deadline_at).format("yyyy-MM-DD hh:mm:ss"),"create"===n?Object(i["b"])(this.coupon).then((function(t){200===t.response.status&&(e.setMsg({msg:"優惠卷新增成功",type:!0}),e.addCoupon(e.coupon),e.toggleLoading())})).catch((function(){e.setMsg({msg:"優惠卷新增失敗",type:!1}),e.toggleLoading()})):Object(i["k"])(this.coupon.id,this.coupon).then((function(t){200===t.response.status&&(e.setMsg({msg:"優惠卷更新成功",type:!0}),e.toggleLoading())})).catch((function(){e.setMsg({msg:"優惠卷更新失敗",type:!1}),e.toggleLoading()}))},cancel:function(){this.clearTempCoupon(),this.togglePage()}}),beforeDestroy:function(){this.clearTempCoupon()}},g=p,f=(n("0e4b"),n("2877")),b=Object(f["a"])(g,u,l,!1,null,"6e558856",null),h=b.exports,v={name:"Coupons",components:{Coupon:h},data:function(){return{loading:!1}},created:function(){var t=this,e=this.$loading.show();Object(i["f"])().then((function(n){t.setCoupons(n.data.data),e.hide()}))},computed:Object(c["a"])(Object(c["a"])({},Object(s["c"])({coupons:"coupon/coupons",page:"page"})),{},{checkEnabled:function(){return function(t){return t?"啟用":"未啟用"}}}),methods:Object(c["a"])(Object(c["a"])({},Object(s["b"])({setMsg:"setMsg",setCoupons:"coupon/setCoupons",setCoupon:"coupon/setCoupon",togglePage:"togglePage"})),{},{openPage:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];"number"===typeof e[0]&&this.setCoupon(this.coupons[e[0]]),this.$forceUpdate(),this.togglePage()},changeAttr:function(t){var e=this,n=this.coupons[t].enabled?"啟用":"停用";Object(i["k"])(this.coupons[t].id,this.coupons[t]).then((function(){e.setMsg({msg:"已".concat(n),type:!0})})).catch((function(){e.coupons[t].enabled=!e.coupons[t].enabled,e.setMsg({msg:"".concat(n,"失敗"),type:!1})}))}}),beforeDestroy:function(){this.page.open&&this.togglePage()}},m=v,C=(n("09a2"),Object(f["a"])(m,o,a,!1,null,"7f7b143a",null));e["default"]=C.exports},afb4:function(t,e,n){}}]);
//# sourceMappingURL=chunk-d54dda82.7702399e.js.map