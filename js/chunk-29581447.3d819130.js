(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-29581447"],{"13d5":function(t,s,e){"use strict";var a=e("23e7"),i=e("d58f").left,n=e("a640"),o=e("ae40"),c=n("reduce"),r=o("reduce",{1:0});a({target:"Array",proto:!0,forced:!c||!r},{reduce:function(t){return i(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"3d85":function(t,s,e){"use strict";var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"steps"},t._l(t.steps,(function(s){return e("div",{key:s.no,staticClass:"step-item",class:t.inStep(s.no)},[e("div",{staticClass:"step-marker"},[t._v(t._s(s.no))]),e("div",{staticClass:"step-details"},[e("p",{staticClass:"step-title"},[t._v(t._s(s.text))])])])})),0)},i=[],n=e("5530"),o=e("2f62"),c={name:"Steps",computed:Object(n["a"])(Object(n["a"])({},Object(o["c"])(["currentStep"])),{},{inStep:function(){var t=this;return function(s){return t.currentStep>=s?"is-active is-success":""}}}),data:function(){return{steps:[{no:1,text:"填寫訂單"},{no:2,text:"訂單確認"},{no:3,text:"確認付款"}]}}},r=c,l=e("2877"),d=Object(l["a"])(r,a,i,!1,null,null,null);s["a"]=d.exports},7781:function(t,s,e){},"7cb4":function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("section",{staticClass:"hero-body"},[e("div",{staticClass:"container"},[e("div",{staticClass:"columns is-centered is-desktop"},[e("div",{staticClass:"column is-two-thirds"},[e("Steps"),e("h4",{staticClass:"h4t has-text-left"},[e("font-awesome-icon",{staticClass:"titleIcon",attrs:{icon:["far","clipboard"]}}),e("span",[t._v(" 購物清單")])],1),e("div",{staticClass:"preview-content mt-1",class:{show:t.isCollapse}},t._l(t.products,(function(s,a){return e("div",{key:a,staticClass:"columns is-marginless has-text-centered is-vcentered is-desktop"},[e("div",{staticClass:"column is-paddingless is-marginless is-3 mobile"},[e("div",{staticClass:"box is-shadowless py-1 px-2"},[e("div",{staticClass:"media"},[e("div",{staticClass:"media-left"},[e("figure",{staticClass:"image is-64x64 is-inline-block mr-1"},[e("img",{attrs:{src:s.product.imageUrl[0]}})])]),e("div",{staticClass:"content"},[e("div",{staticClass:"is-5 has-text-weight-bold"},[t._v(t._s(s.product.title))]),e("p",{staticClass:"is-marginless"},[t._v("x"+t._s(s.quantity))]),e("p",{staticClass:"is-marginless"},[t._v(t._s(t._f("cash")(t.itemTotal(a))))])])])])]),e("div",{staticClass:"column is-3 desktop"},[e("figure",{staticClass:"image is-128x128 is-inline-block mr-1"},[e("img",{attrs:{src:s.product.imageUrl[0]}})])]),e("div",{staticClass:"column desktop"},[t._v(t._s(s.product.title))]),e("div",{staticClass:"column is-1 is-marginless is-paddingless desktop"},[t._v("x"+t._s(s.quantity))]),e("div",{staticClass:"column is-1 mb-1 is-paddingless desktop"},[t._v(t._s(t._f("cash")(t.itemTotal(a))))])])})),0),t.products.length>2?e("div",{staticClass:"buy-item mt-1 mb-2"},[e("button",{staticClass:"collapse",class:t.isCollapse?"up":"down",on:{click:function(s){return t.toggleCollapse()}}},[e("font-awesome-icon",{attrs:{icon:["fas",t.isCollapse?"angle-double-up":"angle-double-down"]}})],1)]):t._e(),e("div",{staticClass:"field has-addons has-addons-right"},[e("p",{staticClass:"control"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.discount.code,expression:"discount.code"}],staticClass:"input desktop",attrs:{type:"text",placeholder:"請輸入折扣碼"},domProps:{value:t.discount.code},on:{change:function(s){t.debounce(t.checkCoupon())},input:function(s){s.target.composing||t.$set(t.discount,"code",s.target.value)}}})]),e("p",{staticClass:"control mobile is-expanded"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.discount.code,expression:"discount.code"}],staticClass:"input is-small mobile",attrs:{type:"text",placeholder:"請輸入折扣碼"},domProps:{value:t.discount.code},on:{change:function(s){t.debounce(t.checkCoupon())},input:function(s){s.target.composing||t.$set(t.discount,"code",s.target.value)}}})]),e("p",{staticClass:"control"},[e("label",{staticClass:"button is-static desktop",class:{"is-loading":t.isLoading}},[e("font-awesome-icon",{attrs:{icon:["fas","tags"]}})],1),e("label",{staticClass:"button is-static is-small mobile",class:{"is-loading":t.isLoading}},[e("font-awesome-icon",{attrs:{icon:["fas","tags"]}})],1)])]),e("div",[t.discount.code?e("div",{staticClass:"has-text-right"},[t.discount.code?e("p",{class:t.couponUseful},[t._v(t._s(t.discount.msg))]):t._e()]):t._e()]),e("div",{staticClass:"subtitle is-5 is-font-Noto is-fullwidth"},[e("div",{staticClass:"has-text-right"},[t._v("總額"),e("span",[t._v(t._s(t._f("cash")(t.countAll)))])])]),e("h4",{staticClass:"h4t has-text-left"},[e("font-awesome-icon",{staticClass:"titleIcon",attrs:{icon:["fas","info-circle"]}}),e("span",[t._v(" 訂單資訊")])],1),e("validation-observer",{on:{submit:function(s){return s.preventDefault(),t.submitForm()}},scopedSlots:t._u([{key:"default",fn:function(s){s.invalid;return[e("form",[e("div",{staticClass:"field"},[e("div",{staticClass:"field-label has-text-left"},[e("label",{staticClass:"label is-normal",attrs:{for:"name"}},[t._v("姓名")])]),e("div",{staticClass:"field-body"},[e("validation-provider",{staticClass:"field",attrs:{name:"姓名",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(s){var a=s.errors,i=s.classes;return[e("p",{staticClass:"control has-icons-left has-icons-right"},[e("span",{staticClass:"icon is-small is-left"},[e("font-awesome-icon",{attrs:{icon:["fas","user"]}})],1),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"input",class:i,attrs:{id:"name",type:"text",required:""},domProps:{value:t.form.name},on:{input:function(s){s.target.composing||t.$set(t.form,"name",s.target.value)}}}),e("span",{staticClass:"icon is-small is-right"},[e("font-awesome-icon",{attrs:{icon:["fas",t.checkedIcon(a[0])]}})],1),a[0]?e("span",{staticClass:"has-text-left help is-danger"},[t._v(t._s(a[0]))]):t._e()])]}}],null,!0)})],1)]),e("div",{staticClass:"field"},[e("div",{staticClass:"field-label has-text-left"},[e("label",{staticClass:"label",attrs:{for:"phone"}},[t._v("電話")])]),e("div",{staticClass:"field-body"},[e("validation-provider",{staticClass:"field filed",attrs:{name:"電話",rules:"required|digits:10"},scopedSlots:t._u([{key:"default",fn:function(s){var a=s.errors,i=s.classes;return[e("p",{staticClass:"control has-icons-left has-icons-right"},[e("span",{staticClass:"icon is-small is-left"},[e("font-awesome-icon",{attrs:{icon:["fas","phone-alt"]}})],1),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.tel,expression:"form.tel"}],staticClass:"input",class:i,attrs:{id:"phone",type:"tel",maxlength:"10",required:""},domProps:{value:t.form.tel},on:{input:function(s){s.target.composing||t.$set(t.form,"tel",s.target.value)}}}),e("span",{staticClass:"icon is-small is-right"},[e("font-awesome-icon",{attrs:{icon:["fas",t.checkedIcon(a[0])]}})],1),a[0]?e("span",{staticClass:"has-text-left help is-danger"},[t._v(t._s(a[0]))]):t._e()])]}}],null,!0)})],1)]),e("div",{staticClass:"field"},[e("div",{staticClass:"field-label has-text-left"},[e("label",{staticClass:"label",attrs:{for:"email"}},[t._v("信箱")])]),e("div",{staticClass:"field-body"},[e("validation-provider",{staticClass:"field",attrs:{name:"信箱",rules:"required|email"},scopedSlots:t._u([{key:"default",fn:function(s){var a=s.errors,i=s.classes;return[e("p",{staticClass:"control has-icons-left has-icons-right"},[e("span",{staticClass:"icon is-small is-left"},[e("font-awesome-icon",{attrs:{icon:["fas","envelope"]}})],1),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.email,expression:"form.email"}],staticClass:"input",class:i,attrs:{id:"email",type:"email",required:""},domProps:{value:t.form.email},on:{input:function(s){s.target.composing||t.$set(t.form,"email",s.target.value)}}}),e("span",{staticClass:"icon is-small is-right"},[e("font-awesome-icon",{attrs:{icon:["fas",t.checkedIcon(a[0])]}})],1),a[0]?e("span",{staticClass:"has-text-left help is-danger"},[t._v(t._s(a[0]))]):t._e()])]}}],null,!0)})],1)]),e("div",{staticClass:"field"},[e("div",{staticClass:"field-label has-text-left"},[e("label",{staticClass:"label",attrs:{for:"address"}},[t._v("收件地址")])]),e("div",{staticClass:"field-body"},[e("validation-provider",{staticClass:"field",attrs:{name:"收件地址",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(s){var a=s.errors,i=s.classes;return[e("p",{staticClass:"control has-icons-left has-icons-right"},[e("span",{staticClass:"icon is-small is-left"},[e("font-awesome-icon",{attrs:{icon:["far","address-card"]}})],1),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.address,expression:"form.address"}],staticClass:"input",class:i,attrs:{id:"address",type:"text",required:""},domProps:{value:t.form.address},on:{input:function(s){s.target.composing||t.$set(t.form,"address",s.target.value)}}}),e("span",{staticClass:"icon is-small is-right"},[e("font-awesome-icon",{attrs:{icon:["fas",t.checkedIcon(a[0])]}})],1),a[0]?e("span",{staticClass:"has-text-left help is-danger"},[t._v(t._s(a[0]))]):t._e()])]}}],null,!0)})],1)]),e("div",{staticClass:"field"},[e("div",{staticClass:"field-label has-text-left"},[e("label",{staticClass:"label",attrs:{for:"remark"}},[t._v("備註"),e("small",{staticClass:"has-text-grey-light"},[t._v("（選填)")])])]),e("div",{staticClass:"field-body"},[e("div",{staticClass:"field"},[e("p",{staticClass:"control has-icons-left has-icons-right"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.remark,expression:"form.remark"}],staticClass:"textarea",attrs:{id:"remark",rows:"5"},domProps:{value:t.form.remark},on:{input:function(s){s.target.composing||t.$set(t.form,"remark",s.target.value)}}})])])])]),e("div",{staticClass:"field"},[e("div",{staticClass:"field-label has-text-left"},[e("label",{staticClass:"label",attrs:{for:"paytype"}},[t._v("付款方式")])]),e("div",{staticClass:"field-body"},[e("validation-provider",{staticClass:"field",attrs:{name:"付款方式",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(s){var a=s.errors,i=s.classes;return[e("div",{staticClass:"control is-expended"},[e("div",{staticClass:"select is-fullwidth",class:i},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.form.payment,expression:"form.payment"}],attrs:{name:"payment",id:"paytype"},on:{change:function(s){var e=Array.prototype.filter.call(s.target.options,(function(t){return t.selected})).map((function(t){var s="_value"in t?t._value:t.value;return s}));t.$set(t.form,"payment",s.target.multiple?e:e[0])}}},[e("option",{attrs:{value:"",disabled:""}},[t._v("---請選擇付款方式---")]),t._l(t.payment,(function(s,a){return e("option",{key:a,domProps:{value:s}},[t._v(t._s(s))])}))],2)]),a[0]?e("span",{staticClass:"has-text-left help is-danger"},[t._v(t._s(a[0]))]):t._e()])]}}],null,!0)})],1)]),e("div",{staticClass:"control buttons is-centered"},[e("button",{staticClass:"button is-text",attrs:{type:"button"},on:{click:function(s){return t.$router.go(-1)}}},[t._v("上一頁")]),e("button",{staticClass:"button is-primary",class:{"is-loading":t.loading}},[t._v("確認訂單")])])])]}}])})],1)])]),e("vue-confirm-dialog")],1)},i=[],n=(e("13d5"),e("5530")),o=e("2f62"),c=e("c1df"),r=e("d58c"),l=e("3d85"),d={name:"Checkout",components:{Steps:l["a"]},data:function(){return{payment:["WebATM","ATM","Barcode","Credit","ApplePay","GooglePay"],form:{name:"",tel:"",email:"",payment:"",address:"",remark:""},discount:{code:"",percent:0,msg:"",type:!1},isCollapse:!1,collapse:!1,isLoading:!1}},created:function(){this.getShopCartData(),this.setCurrentStep(1)},computed:Object(n["a"])(Object(n["a"])({},Object(o["c"])({products:"shopcart/shopcartItems",loading:"loading"})),{},{countAll:function(){var t=this.products.reduce((function(t,s){return t+s.quantity*(s.product.price?s.product.price:s.product.origin_price)}),0);return this.discount.percent?t*(this.discount.percent/100):t},itemTotal:function(){var t=this;return function(s){return t.products[s].quantity*(t.products[s].product.onsale?t.products[s].product.onsale:t.products[s].product.price)}},checkedIcon:function(){return function(t){return t?"exclamation-triangle":"check"}},couponUseful:function(){return this.discount.type?"has-text-success":"has-text-danger"},couponMsg:function(){return this.discount.code?this.discount.type?"折扣".concat(this.discount.percent,"%"):"此優惠碼無效":""}}),watch:{"discount.percent":{handler:function(){return this.countAll&&this.discountMsg}}},methods:Object(n["a"])(Object(n["a"])({},Object(o["b"])({setProducts:"shopcart/setShopcartItems",toggleLoading:"toggleLoading",setMsg:"setMsg",setCurrentStep:"setCurrentStep"})),{},{getShopCartData:function(){var t=this,s=this.$loading.show({container:this.$refs.preivew,isFullPage:!1});Object(r["g"])().then((function(e){t.setProducts(e.data.data),s.hide()}))},submitForm:function(){var t=this;this.toggleLoading(),this.discount.code&&(this.form.coupon=this.discount.code),Object(r["c"])(this.form).then((function(s){t.toggleLoading(),t.$router.push("payflow/".concat(s.data.data.id))}))},checkCoupon:function(){var t=this;this.isLoading=!0,Object(r["b"])(this.discount.code).then((function(s){if(c(s.data.data.deadline.datetime).isAfter(new Date))t.discount={code:t.discount.code,percent:s.data.data.percent,type:!0,msg:"折扣".concat(s.data.data.percent,"%")},t.isLoading=!1;else{var e="酷碰卷已過期";t.setMsg({msg:e,type:!1}),t.discount={code:t.discount.code,percent:0,type:!1,msg:e},t.isLoading=!1}})).catch((function(s){var e=s.response.data.message;t.setMsg({msg:e,type:!1}),t.discount={code:t.discount.code,percent:0,type:!1,msg:e},t.isLoading=!1}))},debounce:function(t){var s,e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return function(){for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];clearTimeout(s),s=setTimeout((function(){return t.apply(e,n)}),a)}},toggleCollapse:function(){this.isCollapse=!this.isCollapse}})},u=d,p=(e("a903"),e("2877")),f=Object(p["a"])(u,a,i,!1,null,"0a98c03e",null);s["default"]=f.exports},a903:function(t,s,e){"use strict";var a=e("7781"),i=e.n(a);i.a},d58c:function(t,s,e){"use strict";e.d(s,"f",(function(){return r})),e.d(s,"h",(function(){return l})),e.d(s,"g",(function(){return d})),e.d(s,"a",(function(){return u})),e.d(s,"k",(function(){return p})),e.d(s,"d",(function(){return f})),e.d(s,"b",(function(){return m})),e.d(s,"c",(function(){return v})),e.d(s,"e",(function(){return h})),e.d(s,"i",(function(){return g})),e.d(s,"j",(function(){return C}));var a=e("5530"),i=e("bc3a"),n=e.n(i),o="dd62b88f-6f23-42a4-8551-b1cb4552bb3e",c=n.a.create({timeout:3e4,baseURL:"https://course-ec-api.hexschool.io/api/".concat(o,"/ec/")}),r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return c.get("products?page=".concat(t))},l=function(t){return c.get("product/".concat(t))},d=function(){return c.get("shopping")},u=function(t,s){return c.post("shopping",{product:t,quantity:s})},p=function(t,s){return c.patch("shopping",{product:t,quantity:s})},f=function(t){return t?c.delete("shopping/".concat(t)):c.delete("shopping/all/product")},m=function(t){return c.post("coupon/search",{code:t})},v=function(t){return c.post("orders",Object(a["a"])({},t))},h=function(){return c.get("orders")},g=function(t){return c.get("orders/".concat(t))},C=function(t){return c.post("orders/".concat(t,"/paying"))}},d58f:function(t,s,e){var a=e("1c0b"),i=e("7b0b"),n=e("44ad"),o=e("50c4"),c=function(t){return function(s,e,c,r){a(e);var l=i(s),d=n(l),u=o(l.length),p=t?u-1:0,f=t?-1:1;if(c<2)while(1){if(p in d){r=d[p],p+=f;break}if(p+=f,t?p<0:u<=p)throw TypeError("Reduce of empty array with no initial value")}for(;t?p>=0:u>p;p+=f)p in d&&(r=e(r,d[p],p,l));return r}};t.exports={left:c(!1),right:c(!0)}}}]);
//# sourceMappingURL=chunk-29581447.3d819130.js.map